<Activity mc:Ignorable="sap sap2010" x:Class="MatchDetailMessage" this:MatchDetailMessage.account="xiaoqi.meng@anruidigital.com" xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:cp="clr-namespace:CustomerClass.ProjectApproval;assembly=CustomerClass" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:mca="clr-namespace:Microsoft.CSharp.Activities;assembly=System.Activities" xmlns:s="clr-namespace:System;assembly=mscorlib" xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation" xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation" xmlns:sc="clr-namespace:System.Collections;assembly=mscorlib" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=mscorlib" xmlns:sco="clr-namespace:System.Collections.ObjectModel;assembly=mscorlib" xmlns:sl="clr-namespace:System.Linq;assembly=System.Core" xmlns:snm="clr-namespace:System.Net.Mail;assembly=System" xmlns:this="clr-namespace:" xmlns:ui="http://schemas.uipath.com/workflow/activities" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <x:Members>
    <x:Property Name="messageInfos" Type="InOutArgument(scg:List(cp:MessageNoticeInfo))" />
    <x:Property Name="account" Type="InArgument(x:String)" />
    <x:Property Name="baseFolder" Type="InArgument(x:String)" />
    <x:Property Name="shouldBeDetailCompanys" Type="InArgument(scg:List(x:String))" />
  </x:Members>
  <sap2010:ExpressionActivityEditor.ExpressionActivityEditor>C#</sap2010:ExpressionActivityEditor.ExpressionActivityEditor>
  <sap:VirtualizedContainerService.HintSize>1043,945</sap:VirtualizedContainerService.HintSize>
  <sap2010:WorkflowViewState.IdRef>ActivityBuilder_1</sap2010:WorkflowViewState.IdRef>
  <TextExpression.NamespacesForImplementation>
    <sco:Collection x:TypeArguments="x:String">
      <x:String>System.Activities</x:String>
      <x:String>System.Activities.Statements</x:String>
      <x:String>System.Activities.Expressions</x:String>
      <x:String>System.Activities.Validation</x:String>
      <x:String>System.Activities.XamlIntegration</x:String>
      <x:String>Microsoft.VisualBasic</x:String>
      <x:String>Microsoft.VisualBasic.Activities</x:String>
      <x:String>System</x:String>
      <x:String>System.Collections</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Data</x:String>
      <x:String>System.Diagnostics</x:String>
      <x:String>System.Drawing</x:String>
      <x:String>System.IO</x:String>
      <x:String>System.Linq</x:String>
      <x:String>System.Net.Mail</x:String>
      <x:String>System.Xml</x:String>
      <x:String>System.Text</x:String>
      <x:String>System.Xml.Linq</x:String>
      <x:String>UiPath.Core</x:String>
      <x:String>UiPath.Core.Activities</x:String>
      <x:String>System.Windows.Markup</x:String>
      <x:String>CustomerClass.ProjectApproval</x:String>
      <x:String>System.Linq.Expressions</x:String>
      <x:String>System.Reflection</x:String>
      <x:String>System.Runtime.InteropServices</x:String>
      <x:String>System.Collections.ObjectModel</x:String>
      <x:String>System.Activities.DynamicUpdate</x:String>
      <x:String>System.Runtime.Serialization</x:String>
      <x:String>UiPath.Mail.Outlook.Enums</x:String>
      <x:String>UiPath.Mail.Outlook.Activities</x:String>
      <x:String>UiPath.Shared.Activities</x:String>
      <x:String>UiPath.Mail.Activities</x:String>
      <x:String>UiPath.PDF.Activities</x:String>
      <x:String>System.Collections.Specialized</x:String>
    </sco:Collection>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <sco:Collection x:TypeArguments="AssemblyReference">
      <AssemblyReference>Microsoft.CSharp</AssemblyReference>
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System.Runtime.Serialization</AssemblyReference>
      <AssemblyReference>System.ServiceModel</AssemblyReference>
      <AssemblyReference>System.ServiceModel.Activities</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>Microsoft.VisualBasic</AssemblyReference>
      <AssemblyReference>mscorlib</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>System.Drawing</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
      <AssemblyReference>System.Xml.Linq</AssemblyReference>
      <AssemblyReference>PresentationFramework</AssemblyReference>
      <AssemblyReference>WindowsBase</AssemblyReference>
      <AssemblyReference>PresentationCore</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities</AssemblyReference>
      <AssemblyReference>UiPath.UiAutomation.Activities</AssemblyReference>
      <AssemblyReference>Microsoft.Bcl.AsyncInterfaces</AssemblyReference>
      <AssemblyReference>CustomerClass</AssemblyReference>
      <AssemblyReference>System.ValueTuple</AssemblyReference>
      <AssemblyReference>System.ComponentModel.Composition</AssemblyReference>
      <AssemblyReference>UiPath.Mail</AssemblyReference>
      <AssemblyReference>UiPath.Excel</AssemblyReference>
      <AssemblyReference>System.Memory</AssemblyReference>
      <AssemblyReference>UiPath.OCR.Activities.Design</AssemblyReference>
      <AssemblyReference>UiPath.UIAutomationCore</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities.Design</AssemblyReference>
      <AssemblyReference>UiPath.Mail.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Excel.Activities</AssemblyReference>
      <AssemblyReference>UiPath.OCR.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Mail.Activities.Design</AssemblyReference>
      <AssemblyReference>UiPath.PDF.Activities</AssemblyReference>
      <AssemblyReference>System.Runtime.WindowsRuntime</AssemblyReference>
    </sco:Collection>
  </TextExpression.ReferencesForImplementation>
  <Sequence DisplayName="MatchDetailMessage" sap:VirtualizedContainerService.HintSize="354,780" sap2010:WorkflowViewState.IdRef="Sequence_1">
    <Sequence.Variables>
      <Variable x:TypeArguments="scg:IEnumerable(sl:IGrouping(x:String, cp:MessageNoticeInfo))" Name="messageGroup" />
      <Variable x:TypeArguments="scg:List(cp:MessageDetailInfo)" Name="messageDetailStrs">
        <Variable.Default>
          <mca:CSharpValue x:TypeArguments="scg:List(cp:MessageDetailInfo)" sap2010:WorkflowViewState.IdRef="CSharpValue`1_19">new List&lt;MessageDetailInfo&gt;()</mca:CSharpValue>
        </Variable.Default>
      </Variable>
      <Variable x:TypeArguments="scg:List(cp:MessageDetailInfo)" Name="messageDetails">
        <Variable.Default>
          <mca:CSharpValue x:TypeArguments="scg:List(cp:MessageDetailInfo)" sap2010:WorkflowViewState.IdRef="CSharpValue`1_178">new List&lt;MessageDetailInfo&gt;()</mca:CSharpValue>
        </Variable.Default>
      </Variable>
      <Variable x:TypeArguments="scg:IEnumerable(scg:KeyValuePair(x:String, x:Decimal))" Name="sums" />
    </Sequence.Variables>
    <sap:WorkflowViewStateService.ViewState>
      <scg:Dictionary x:TypeArguments="x:String, x:Object">
        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
      </scg:Dictionary>
    </sap:WorkflowViewStateService.ViewState>
    <Assign sap:VirtualizedContainerService.HintSize="312,61" sap2010:WorkflowViewState.IdRef="Assign_1">
      <Assign.To>
        <OutArgument x:TypeArguments="scg:IEnumerable(sl:IGrouping(x:String, cp:MessageNoticeInfo))">
          <mca:CSharpReference x:TypeArguments="scg:IEnumerable(sl:IGrouping(x:String, cp:MessageNoticeInfo))" sap2010:WorkflowViewState.IdRef="CSharpReference`1_3">messageGroup</mca:CSharpReference>
        </OutArgument>
      </Assign.To>
      <Assign.Value>
        <InArgument x:TypeArguments="scg:IEnumerable(sl:IGrouping(x:String, cp:MessageNoticeInfo))">
          <mca:CSharpValue x:TypeArguments="scg:IEnumerable(sl:IGrouping(x:String, cp:MessageNoticeInfo))" sap2010:WorkflowViewState.IdRef="CSharpValue`1_193">messageInfos.Where(r=&gt;shouldBeDetailCompanys.Contains(r.CompanyName)).GroupBy(r=&gt;r.CompanyName)</mca:CSharpValue>
        </InArgument>
      </Assign.Value>
    </Assign>
    <ui:ForEach x:TypeArguments="sl:IGrouping(x:String, cp:MessageNoticeInfo)" CurrentIndex="{x:Null}" DisplayName="读取明细到集合中" sap:VirtualizedContainerService.HintSize="312,53" sap2010:WorkflowViewState.IdRef="ForEach`1_3">
      <ui:ForEach.Body>
        <ActivityAction x:TypeArguments="sl:IGrouping(x:String, cp:MessageNoticeInfo)">
          <ActivityAction.Argument>
            <DelegateInArgument x:TypeArguments="sl:IGrouping(x:String, cp:MessageNoticeInfo)" Name="item" />
          </ActivityAction.Argument>
          <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="546,972" sap2010:WorkflowViewState.IdRef="Sequence_2">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <Switch x:TypeArguments="x:String" DisplayName="Switch" sap:VirtualizedContainerService.HintSize="504,880" sap2010:WorkflowViewState.IdRef="Switch`1_1">
              <Switch.Expression>
                <InArgument x:TypeArguments="x:String">
                  <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_15">item.Key</mca:CSharpValue>
                </InArgument>
              </Switch.Expression>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <Sequence x:Key="思爱普（中国）有限公司" sap:VirtualizedContainerService.HintSize="376,569" sap2010:WorkflowViewState.IdRef="Sequence_3">
                <Sequence.Variables>
                  <Variable x:TypeArguments="s:DateTime" Name="tmpMaxDate" />
                  <Variable x:TypeArguments="s:DateTime" Name="tmpMinDate" />
                  <Variable x:TypeArguments="scg:List(snm:MailMessage)" Name="detailMessages" />
                </Sequence.Variables>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="334,129" sap2010:WorkflowViewState.IdRef="MultipleAssign_3">
                  <ui:MultipleAssign.AssignOperations>
                    <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_3">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="s:DateTime">
                            <mca:CSharpReference x:TypeArguments="s:DateTime" sap2010:WorkflowViewState.IdRef="CSharpReference`1_8">tmpMaxDate</mca:CSharpReference>
                          </OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="s:DateTime">
                            <mca:CSharpValue x:TypeArguments="s:DateTime" sap2010:WorkflowViewState.IdRef="CSharpValue`1_199">item.Select(r=&gt;r.DaoKuanDate).Max().AddDays(5)</mca:CSharpValue>
                          </InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_4">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="s:DateTime">
                            <mca:CSharpReference x:TypeArguments="s:DateTime" sap2010:WorkflowViewState.IdRef="CSharpReference`1_9">tmpMinDate</mca:CSharpReference>
                          </OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="s:DateTime">
                            <mca:CSharpValue x:TypeArguments="s:DateTime" sap2010:WorkflowViewState.IdRef="CSharpValue`1_212">item.Select(r=&gt;r.DaoKuanDate).Min().AddDays(-5)</mca:CSharpValue>
                          </InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                    </scg:List>
                  </ui:MultipleAssign.AssignOperations>
                </ui:MultipleAssign>
                <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="获取邮件详情" sap:VirtualizedContainerService.HintSize="334,114" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_2" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Email\\GetMailMessage.xaml">
                  <ui:InvokeWorkflowFile.Arguments>
                    <InArgument x:TypeArguments="x:String" x:Key="account">
                      <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_16">account</mca:CSharpValue>
                    </InArgument>
                    <InArgument x:TypeArguments="x:String" x:Key="condition">
                      <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_197">"[SenderEmailAddress] = 'ap.china@sap.com' AND [ReceivedTime] &gt;= '"+tmpMinDate.ToString("d")+" 00:00AM' AND [ReceivedTime] &lt; '"+tmpMaxDate.ToString("d")+" 00:00AM'"</mca:CSharpValue>
                    </InArgument>
                    <OutArgument x:TypeArguments="scg:List(snm:MailMessage)" x:Key="messages">
                      <mca:CSharpReference x:TypeArguments="scg:List(snm:MailMessage)" sap2010:WorkflowViewState.IdRef="CSharpReference`1_10">detailMessages</mca:CSharpReference>
                    </OutArgument>
                    <InArgument x:TypeArguments="x:String" x:Key="mailFolder">收件箱\银行\思爱普账单</InArgument>
                  </ui:InvokeWorkflowFile.Arguments>
                </ui:InvokeWorkflowFile>
                <Assign DisplayName="思爱普筛选内容为空的" sap:VirtualizedContainerService.HintSize="334,61" sap2010:WorkflowViewState.IdRef="Assign_5">
                  <Assign.To>
                    <OutArgument x:TypeArguments="scg:List(snm:MailMessage)">
                      <mca:CSharpReference x:TypeArguments="scg:List(snm:MailMessage)" sap2010:WorkflowViewState.IdRef="CSharpReference`1_129">detailMessages</mca:CSharpReference>
                    </OutArgument>
                  </Assign.To>
                  <Assign.Value>
                    <InArgument x:TypeArguments="scg:List(snm:MailMessage)">
                      <mca:CSharpValue x:TypeArguments="scg:List(snm:MailMessage)" sap2010:WorkflowViewState.IdRef="CSharpValue`1_219">detailMessages.Where(r=&gt;r.Attachments.Count == 1 &amp;&amp; Path.GetExtension(r.Attachments.FirstOrDefault().Name).ToLower() == ".pdf").ToList()</mca:CSharpValue>
                    </InArgument>
                  </Assign.Value>
                </Assign>
                <ui:ForEach x:TypeArguments="snm:MailMessage" CurrentIndex="{x:Null}" DisplayName="For Each" sap:VirtualizedContainerService.HintSize="334,53" sap2010:WorkflowViewState.IdRef="ForEach`1_4">
                  <ui:ForEach.Body>
                    <ActivityAction x:TypeArguments="snm:MailMessage">
                      <ActivityAction.Argument>
                        <DelegateInArgument x:TypeArguments="snm:MailMessage" Name="detailMessage" />
                      </ActivityAction.Argument>
                      <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="376,838" sap2010:WorkflowViewState.IdRef="Sequence_4">
                        <Sequence.Variables>
                          <Variable x:TypeArguments="scg:IEnumerable(x:String)" Name="tmpAttachmentPaths" />
                          <Variable x:TypeArguments="x:String" Name="tmpText" />
                          <Variable x:TypeArguments="cp:MessageDetailInfo" Name="tmpMessageInfo" />
                        </Sequence.Variables>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:SaveMailAttachments DisplayName="Save Attachments" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="SaveMailAttachments_1" OverwriteExisting="False">
                          <ui:SaveMailAttachments.Attachments>
                            <OutArgument x:TypeArguments="scg:IEnumerable(x:String)">
                              <mca:CSharpReference x:TypeArguments="scg:IEnumerable(x:String)" sap2010:WorkflowViewState.IdRef="CSharpReference`1_11">tmpAttachmentPaths</mca:CSharpReference>
                            </OutArgument>
                          </ui:SaveMailAttachments.Attachments>
                          <ui:SaveMailAttachments.FolderPath>
                            <InArgument x:TypeArguments="x:String">
                              <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_21">baseFolder + "\\Attachments"</mca:CSharpValue>
                            </InArgument>
                          </ui:SaveMailAttachments.FolderPath>
                          <ui:SaveMailAttachments.Message>
                            <InArgument x:TypeArguments="snm:MailMessage">
                              <mca:CSharpValue x:TypeArguments="snm:MailMessage" sap2010:WorkflowViewState.IdRef="CSharpValue`1_22">detailMessage</mca:CSharpValue>
                            </InArgument>
                          </ui:SaveMailAttachments.Message>
                        </ui:SaveMailAttachments>
                        <ui:ReadPDFText PreserveFormatting="{x:Null}" DisplayName="Read PDF Text" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="ReadPDFText_1" Range="All">
                          <ui:ReadPDFText.FileName>
                            <InArgument x:TypeArguments="x:String">
                              <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_24">tmpAttachmentPaths.FirstOrDefault()</mca:CSharpValue>
                            </InArgument>
                          </ui:ReadPDFText.FileName>
                          <ui:ReadPDFText.Text>
                            <OutArgument x:TypeArguments="x:String">
                              <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_12">tmpText</mca:CSharpReference>
                            </OutArgument>
                          </ui:ReadPDFText.Text>
                        </ui:ReadPDFText>
                        <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="334,222" sap2010:WorkflowViewState.IdRef="MultipleAssign_4">
                          <ui:MultipleAssign.AssignOperations>
                            <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_5">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="cp:MessageDetailInfo">
                                    <mca:CSharpReference x:TypeArguments="cp:MessageDetailInfo" sap2010:WorkflowViewState.IdRef="CSharpReference`1_15">tmpMessageInfo</mca:CSharpReference>
                                  </OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="cp:MessageDetailInfo">
                                    <mca:CSharpValue x:TypeArguments="cp:MessageDetailInfo" sap2010:WorkflowViewState.IdRef="CSharpValue`1_28">new MessageDetailInfo()</mca:CSharpValue>
                                  </InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_6">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="x:String">
                                    <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_16">tmpMessageInfo.MessageId</mca:CSharpReference>
                                  </OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="x:String">
                                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_30">detailMessage.Headers.Get("Message-ID")</mca:CSharpValue>
                                  </InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_7">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="x:String">
                                    <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_17">tmpMessageInfo.MessageBody</mca:CSharpReference>
                                  </OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="x:String">
                                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_31">tmpText</mca:CSharpValue>
                                  </InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_8">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="x:String">
                                    <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_18">tmpMessageInfo.CompanyName</mca:CSharpReference>
                                  </OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="x:String">
                                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_32">item.Key</mca:CSharpValue>
                                  </InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_9">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="x:String">
                                    <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_19">tmpMessageInfo.BankName</mca:CSharpReference>
                                  </OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="x:String">浦发银行</InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                            </scg:List>
                          </ui:MultipleAssign.AssignOperations>
                        </ui:MultipleAssign>
                        <InvokeMethod DisplayName="Invoke Method" sap:VirtualizedContainerService.HintSize="334,137" sap2010:WorkflowViewState.IdRef="InvokeMethod_1" MethodName="Add">
                          <InvokeMethod.TargetObject>
                            <InArgument x:TypeArguments="scg:List(cp:MessageDetailInfo)">
                              <mca:CSharpValue x:TypeArguments="scg:List(cp:MessageDetailInfo)" sap2010:WorkflowViewState.IdRef="CSharpValue`1_35">messageDetailStrs</mca:CSharpValue>
                            </InArgument>
                          </InvokeMethod.TargetObject>
                          <InArgument x:TypeArguments="cp:MessageDetailInfo">
                            <mca:CSharpValue x:TypeArguments="cp:MessageDetailInfo" sap2010:WorkflowViewState.IdRef="CSharpValue`1_34">tmpMessageInfo</mca:CSharpValue>
                          </InArgument>
                        </InvokeMethod>
                        <ui:Delete ContinueOnError="{x:Null}" sap:VirtualizedContainerService.HintSize="334,81" sap2010:WorkflowViewState.IdRef="Delete_1">
                          <ui:Delete.Path>
                            <InArgument x:TypeArguments="x:String">
                              <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_36">tmpAttachmentPaths.FirstOrDefault()</mca:CSharpValue>
                            </InArgument>
                          </ui:Delete.Path>
                        </ui:Delete>
                      </Sequence>
                    </ActivityAction>
                  </ui:ForEach.Body>
                  <ui:ForEach.Values>
                    <InArgument x:TypeArguments="sc:IEnumerable">
                      <mca:CSharpValue x:TypeArguments="sc:IEnumerable" sap2010:WorkflowViewState.IdRef="CSharpValue`1_20">detailMessages</mca:CSharpValue>
                    </InArgument>
                  </ui:ForEach.Values>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:ForEach>
              </Sequence>
              <Sequence x:Key="微软（中国）有限公司" sap:VirtualizedContainerService.HintSize="376,468" sap2010:WorkflowViewState.IdRef="Sequence_6">
                <Sequence.Variables>
                  <Variable x:TypeArguments="s:DateTime" Name="tmpMaxDate" />
                  <Variable x:TypeArguments="s:DateTime" Name="tmpMinDate" />
                  <Variable x:TypeArguments="scg:List(snm:MailMessage)" Name="detailMessages" />
                </Sequence.Variables>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="412,53" sap2010:WorkflowViewState.IdRef="MultipleAssign_5">
                  <ui:MultipleAssign.AssignOperations>
                    <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_10">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="s:DateTime">
                            <mca:CSharpReference x:TypeArguments="s:DateTime" sap2010:WorkflowViewState.IdRef="CSharpReference`1_20">tmpMaxDate</mca:CSharpReference>
                          </OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="s:DateTime">
                            <mca:CSharpValue x:TypeArguments="s:DateTime" sap2010:WorkflowViewState.IdRef="CSharpValue`1_201">item.Select(r=&gt;r.DaoKuanDate).Max().AddDays(5)</mca:CSharpValue>
                          </InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_11">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="s:DateTime">
                            <mca:CSharpReference x:TypeArguments="s:DateTime" sap2010:WorkflowViewState.IdRef="CSharpReference`1_21">tmpMinDate</mca:CSharpReference>
                          </OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="s:DateTime">
                            <mca:CSharpValue x:TypeArguments="s:DateTime" sap2010:WorkflowViewState.IdRef="CSharpValue`1_213">item.Select(r=&gt;r.DaoKuanDate).Min().AddDays(-5)</mca:CSharpValue>
                          </InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                    </scg:List>
                  </ui:MultipleAssign.AssignOperations>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:MultipleAssign>
                <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="获取邮件详情" sap:VirtualizedContainerService.HintSize="412,114" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_3" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Email\\GetMailMessage.xaml">
                  <ui:InvokeWorkflowFile.Arguments>
                    <InArgument x:TypeArguments="x:String" x:Key="account">
                      <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_39">account</mca:CSharpValue>
                    </InArgument>
                    <InArgument x:TypeArguments="x:String" x:Key="condition">
                      <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_198">"[SenderEmailAddress] = 'MSSADM@MICROSOFT.COM' AND [ReceivedTime] &gt;= '"+tmpMinDate.ToString("d")+" 00:00AM' AND [ReceivedTime] &lt; '"+tmpMaxDate.ToString("d")+" 00:00AM'"</mca:CSharpValue>
                    </InArgument>
                    <OutArgument x:TypeArguments="scg:List(snm:MailMessage)" x:Key="messages">
                      <mca:CSharpReference x:TypeArguments="scg:List(snm:MailMessage)" sap2010:WorkflowViewState.IdRef="CSharpReference`1_22">detailMessages</mca:CSharpReference>
                    </OutArgument>
                    <InArgument x:TypeArguments="x:String" x:Key="mailFolder">收件箱\银行\微软账单</InArgument>
                  </ui:InvokeWorkflowFile.Arguments>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:InvokeWorkflowFile>
                <ui:ForEach x:TypeArguments="snm:MailMessage" CurrentIndex="{x:Null}" DisplayName="For Each" sap:VirtualizedContainerService.HintSize="412,53" sap2010:WorkflowViewState.IdRef="ForEach`1_5">
                  <ui:ForEach.Body>
                    <ActivityAction x:TypeArguments="snm:MailMessage">
                      <ActivityAction.Argument>
                        <DelegateInArgument x:TypeArguments="snm:MailMessage" Name="detailMessage" />
                      </ActivityAction.Argument>
                      <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="376,491" sap2010:WorkflowViewState.IdRef="Sequence_5">
                        <Sequence.Variables>
                          <Variable x:TypeArguments="scg:IEnumerable(x:String)" Name="tmpAttachmentPaths" />
                          <Variable x:TypeArguments="cp:MessageDetailInfo" Name="tmpMessageInfo" />
                        </Sequence.Variables>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="334,222" sap2010:WorkflowViewState.IdRef="MultipleAssign_6">
                          <ui:MultipleAssign.AssignOperations>
                            <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_12">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="cp:MessageDetailInfo">
                                    <mca:CSharpReference x:TypeArguments="cp:MessageDetailInfo" sap2010:WorkflowViewState.IdRef="CSharpReference`1_23">tmpMessageInfo</mca:CSharpReference>
                                  </OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="cp:MessageDetailInfo">
                                    <mca:CSharpValue x:TypeArguments="cp:MessageDetailInfo" sap2010:WorkflowViewState.IdRef="CSharpValue`1_41">new MessageDetailInfo()</mca:CSharpValue>
                                  </InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_13">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="x:String">
                                    <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_24">tmpMessageInfo.MessageId</mca:CSharpReference>
                                  </OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="x:String">
                                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_42">detailMessage.Headers.Get("Message-ID")</mca:CSharpValue>
                                  </InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_14">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="x:String">
                                    <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_25">tmpMessageInfo.MessageBody</mca:CSharpReference>
                                  </OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="x:String">
                                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_43">detailMessage.Body</mca:CSharpValue>
                                  </InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_15">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="x:String">
                                    <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_26">tmpMessageInfo.CompanyName</mca:CSharpReference>
                                  </OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="x:String">
                                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_44">item.Key</mca:CSharpValue>
                                  </InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_16">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="x:String">
                                    <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_27">tmpMessageInfo.BankName</mca:CSharpReference>
                                  </OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="x:String">浦发银行</InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                            </scg:List>
                          </ui:MultipleAssign.AssignOperations>
                        </ui:MultipleAssign>
                        <InvokeMethod DisplayName="Invoke Method" sap:VirtualizedContainerService.HintSize="334,137" sap2010:WorkflowViewState.IdRef="InvokeMethod_2" MethodName="Add">
                          <InvokeMethod.TargetObject>
                            <InArgument x:TypeArguments="scg:List(cp:MessageDetailInfo)">
                              <mca:CSharpValue x:TypeArguments="scg:List(cp:MessageDetailInfo)" sap2010:WorkflowViewState.IdRef="CSharpValue`1_46">messageDetailStrs</mca:CSharpValue>
                            </InArgument>
                          </InvokeMethod.TargetObject>
                          <InArgument x:TypeArguments="cp:MessageDetailInfo">
                            <mca:CSharpValue x:TypeArguments="cp:MessageDetailInfo" sap2010:WorkflowViewState.IdRef="CSharpValue`1_45">tmpMessageInfo</mca:CSharpValue>
                          </InArgument>
                        </InvokeMethod>
                      </Sequence>
                    </ActivityAction>
                  </ui:ForEach.Body>
                  <ui:ForEach.Values>
                    <InArgument x:TypeArguments="sc:IEnumerable">
                      <mca:CSharpValue x:TypeArguments="sc:IEnumerable" sap2010:WorkflowViewState.IdRef="CSharpValue`1_47">detailMessages</mca:CSharpValue>
                    </InArgument>
                  </ui:ForEach.Values>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:ForEach>
              </Sequence>
              <Sequence x:Key="甲骨文（中国）软件系统有限公司" sap:VirtualizedContainerService.HintSize="454,1043" sap2010:WorkflowViewState.IdRef="Sequence_8">
                <Sequence.Variables>
                  <Variable x:TypeArguments="s:DateTime" Name="tmpMaxDate" />
                  <Variable x:TypeArguments="s:DateTime" Name="tmpMinDate" />
                  <Variable x:TypeArguments="scg:List(snm:MailMessage)" Name="detailMessages" />
                </Sequence.Variables>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="412,129" sap2010:WorkflowViewState.IdRef="MultipleAssign_7">
                  <ui:MultipleAssign.AssignOperations>
                    <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_17">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="s:DateTime">
                            <mca:CSharpReference x:TypeArguments="s:DateTime" sap2010:WorkflowViewState.IdRef="CSharpReference`1_28">tmpMaxDate</mca:CSharpReference>
                          </OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="s:DateTime">
                            <mca:CSharpValue x:TypeArguments="s:DateTime" sap2010:WorkflowViewState.IdRef="CSharpValue`1_203">item.Select(r=&gt;r.DaoKuanDate).Max().AddDays(5)</mca:CSharpValue>
                          </InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_18">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="s:DateTime">
                            <mca:CSharpReference x:TypeArguments="s:DateTime" sap2010:WorkflowViewState.IdRef="CSharpReference`1_29">tmpMinDate</mca:CSharpReference>
                          </OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="s:DateTime">
                            <mca:CSharpValue x:TypeArguments="s:DateTime" sap2010:WorkflowViewState.IdRef="CSharpValue`1_214">item.Select(r=&gt;r.DaoKuanDate).Min().AddDays(-5)</mca:CSharpValue>
                          </InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                    </scg:List>
                  </ui:MultipleAssign.AssignOperations>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:MultipleAssign>
                <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="获取邮件详情" sap:VirtualizedContainerService.HintSize="412,114" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_4" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Email\\GetMailMessage.xaml">
                  <ui:InvokeWorkflowFile.Arguments>
                    <InArgument x:TypeArguments="x:String" x:Key="account">
                      <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_52">account</mca:CSharpValue>
                    </InArgument>
                    <InArgument x:TypeArguments="x:String" x:Key="condition">
                      <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_51">"[SenderEmailAddress] = 'p2p-helpdesk_ww@oracle.com' AND [ReceivedTime] &gt;= '"+tmpMinDate.ToString("d")+" 00:00AM' AND [ReceivedTime] &lt; '"+tmpMaxDate.ToString("d")+" 00:00AM'"</mca:CSharpValue>
                    </InArgument>
                    <OutArgument x:TypeArguments="scg:List(snm:MailMessage)" x:Key="messages">
                      <mca:CSharpReference x:TypeArguments="scg:List(snm:MailMessage)" sap2010:WorkflowViewState.IdRef="CSharpReference`1_30">detailMessages</mca:CSharpReference>
                    </OutArgument>
                    <InArgument x:TypeArguments="x:String" x:Key="mailFolder">收件箱\银行\甲骨文账单</InArgument>
                  </ui:InvokeWorkflowFile.Arguments>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:InvokeWorkflowFile>
                <ui:ForEach x:TypeArguments="snm:MailMessage" CurrentIndex="{x:Null}" DisplayName="For Each" sap:VirtualizedContainerService.HintSize="412,628" sap2010:WorkflowViewState.IdRef="ForEach`1_6">
                  <ui:ForEach.Body>
                    <ActivityAction x:TypeArguments="snm:MailMessage">
                      <ActivityAction.Argument>
                        <DelegateInArgument x:TypeArguments="snm:MailMessage" Name="detailMessage" />
                      </ActivityAction.Argument>
                      <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="376,491" sap2010:WorkflowViewState.IdRef="Sequence_7">
                        <Sequence.Variables>
                          <Variable x:TypeArguments="scg:IEnumerable(x:String)" Name="tmpAttachmentPaths" />
                          <Variable x:TypeArguments="cp:MessageDetailInfo" Name="tmpMessageInfo" />
                        </Sequence.Variables>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="334,222" sap2010:WorkflowViewState.IdRef="MultipleAssign_8">
                          <ui:MultipleAssign.AssignOperations>
                            <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_19">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="cp:MessageDetailInfo">
                                    <mca:CSharpReference x:TypeArguments="cp:MessageDetailInfo" sap2010:WorkflowViewState.IdRef="CSharpReference`1_31">tmpMessageInfo</mca:CSharpReference>
                                  </OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="cp:MessageDetailInfo">
                                    <mca:CSharpValue x:TypeArguments="cp:MessageDetailInfo" sap2010:WorkflowViewState.IdRef="CSharpValue`1_53">new MessageDetailInfo()</mca:CSharpValue>
                                  </InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_20">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="x:String">
                                    <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_32">tmpMessageInfo.MessageId</mca:CSharpReference>
                                  </OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="x:String">
                                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_54">detailMessage.Headers.Get("Message-ID")</mca:CSharpValue>
                                  </InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_21">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="x:String">
                                    <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_33">tmpMessageInfo.MessageBody</mca:CSharpReference>
                                  </OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="x:String">
                                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_55">detailMessage.Body</mca:CSharpValue>
                                  </InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_22">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="x:String">
                                    <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_34">tmpMessageInfo.CompanyName</mca:CSharpReference>
                                  </OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="x:String">
                                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_56">item.Key</mca:CSharpValue>
                                  </InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_23">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="x:String">
                                    <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_35">tmpMessageInfo.BankName</mca:CSharpReference>
                                  </OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="x:String">浦发银行</InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                            </scg:List>
                          </ui:MultipleAssign.AssignOperations>
                        </ui:MultipleAssign>
                        <InvokeMethod DisplayName="Invoke Method" sap:VirtualizedContainerService.HintSize="334,137" sap2010:WorkflowViewState.IdRef="InvokeMethod_3" MethodName="Add">
                          <InvokeMethod.TargetObject>
                            <InArgument x:TypeArguments="scg:List(cp:MessageDetailInfo)">
                              <mca:CSharpValue x:TypeArguments="scg:List(cp:MessageDetailInfo)" sap2010:WorkflowViewState.IdRef="CSharpValue`1_58">messageDetailStrs</mca:CSharpValue>
                            </InArgument>
                          </InvokeMethod.TargetObject>
                          <InArgument x:TypeArguments="cp:MessageDetailInfo">
                            <mca:CSharpValue x:TypeArguments="cp:MessageDetailInfo" sap2010:WorkflowViewState.IdRef="CSharpValue`1_57">tmpMessageInfo</mca:CSharpValue>
                          </InArgument>
                        </InvokeMethod>
                      </Sequence>
                    </ActivityAction>
                  </ui:ForEach.Body>
                  <ui:ForEach.Values>
                    <InArgument x:TypeArguments="sc:IEnumerable">
                      <mca:CSharpValue x:TypeArguments="sc:IEnumerable" sap2010:WorkflowViewState.IdRef="CSharpValue`1_59">detailMessages</mca:CSharpValue>
                    </InArgument>
                  </ui:ForEach.Values>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:ForEach>
              </Sequence>
              <Sequence x:Key="宁夏西云数据科技有限公司" sap:VirtualizedContainerService.HintSize="376,70" sap2010:WorkflowViewState.IdRef="Sequence_16">
                <Sequence.Variables>
                  <Variable x:TypeArguments="s:DateTime" Name="tmpMaxDate" />
                  <Variable x:TypeArguments="s:DateTime" Name="tmpMinDate" />
                  <Variable x:TypeArguments="scg:List(snm:MailMessage)" Name="detailMessages" />
                </Sequence.Variables>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="334,129" sap2010:WorkflowViewState.IdRef="MultipleAssign_15">
                  <ui:MultipleAssign.AssignOperations>
                    <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_45">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="s:DateTime">
                            <mca:CSharpReference x:TypeArguments="s:DateTime" sap2010:WorkflowViewState.IdRef="CSharpReference`1_60">tmpMaxDate</mca:CSharpReference>
                          </OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="s:DateTime">
                            <mca:CSharpValue x:TypeArguments="s:DateTime" sap2010:WorkflowViewState.IdRef="CSharpValue`1_205">item.Select(r=&gt;r.DaoKuanDate).Max().AddDays(5)</mca:CSharpValue>
                          </InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_46">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="s:DateTime">
                            <mca:CSharpReference x:TypeArguments="s:DateTime" sap2010:WorkflowViewState.IdRef="CSharpReference`1_61">tmpMinDate</mca:CSharpReference>
                          </OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="s:DateTime">
                            <mca:CSharpValue x:TypeArguments="s:DateTime" sap2010:WorkflowViewState.IdRef="CSharpValue`1_215">item.Select(r=&gt;r.DaoKuanDate).Min().AddDays(-5)</mca:CSharpValue>
                          </InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                    </scg:List>
                  </ui:MultipleAssign.AssignOperations>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:MultipleAssign>
                <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="获取邮件详情" sap:VirtualizedContainerService.HintSize="334,114" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_8" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Email\\GetMailMessage.xaml">
                  <ui:InvokeWorkflowFile.Arguments>
                    <InArgument x:TypeArguments="x:String" x:Key="account">
                      <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_97">account</mca:CSharpValue>
                    </InArgument>
                    <InArgument x:TypeArguments="x:String" x:Key="condition">
                      <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_96">"[SenderEmailAddress] = 'noreply@nwcdcloud.cn' AND [ReceivedTime] &gt;= '"+tmpMinDate.ToString("d")+" 00:00AM' AND [ReceivedTime] &lt; '"+tmpMaxDate.ToString("d")+" 00:00AM'"</mca:CSharpValue>
                    </InArgument>
                    <OutArgument x:TypeArguments="scg:List(snm:MailMessage)" x:Key="messages">
                      <mca:CSharpReference x:TypeArguments="scg:List(snm:MailMessage)" sap2010:WorkflowViewState.IdRef="CSharpReference`1_62">detailMessages</mca:CSharpReference>
                    </OutArgument>
                    <InArgument x:TypeArguments="x:String" x:Key="mailFolder">收件箱\银行\西云数据账单</InArgument>
                  </ui:InvokeWorkflowFile.Arguments>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:InvokeWorkflowFile>
                <ui:ForEach x:TypeArguments="snm:MailMessage" CurrentIndex="{x:Null}" DisplayName="For Each" sap:VirtualizedContainerService.HintSize="334,53" sap2010:WorkflowViewState.IdRef="ForEach`1_10">
                  <ui:ForEach.Body>
                    <ActivityAction x:TypeArguments="snm:MailMessage">
                      <ActivityAction.Argument>
                        <DelegateInArgument x:TypeArguments="snm:MailMessage" Name="detailMessage" />
                      </ActivityAction.Argument>
                      <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="376,491" sap2010:WorkflowViewState.IdRef="Sequence_15">
                        <Sequence.Variables>
                          <Variable x:TypeArguments="scg:IEnumerable(x:String)" Name="tmpAttachmentPaths" />
                          <Variable x:TypeArguments="cp:MessageDetailInfo" Name="tmpMessageInfo" />
                        </Sequence.Variables>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="334,222" sap2010:WorkflowViewState.IdRef="MultipleAssign_16">
                          <ui:MultipleAssign.AssignOperations>
                            <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_47">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="cp:MessageDetailInfo">
                                    <mca:CSharpReference x:TypeArguments="cp:MessageDetailInfo" sap2010:WorkflowViewState.IdRef="CSharpReference`1_63">tmpMessageInfo</mca:CSharpReference>
                                  </OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="cp:MessageDetailInfo">
                                    <mca:CSharpValue x:TypeArguments="cp:MessageDetailInfo" sap2010:WorkflowViewState.IdRef="CSharpValue`1_98">new MessageDetailInfo()</mca:CSharpValue>
                                  </InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_48">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="x:String">
                                    <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_64">tmpMessageInfo.MessageId</mca:CSharpReference>
                                  </OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="x:String">
                                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_99">detailMessage.Headers.Get("Message-ID")</mca:CSharpValue>
                                  </InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_49">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="x:String">
                                    <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_65">tmpMessageInfo.MessageBody</mca:CSharpReference>
                                  </OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="x:String">
                                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_100">detailMessage.Body</mca:CSharpValue>
                                  </InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_50">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="x:String">
                                    <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_66">tmpMessageInfo.CompanyName</mca:CSharpReference>
                                  </OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="x:String">
                                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_101">item.Key</mca:CSharpValue>
                                  </InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_51">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="x:String">
                                    <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_67">tmpMessageInfo.BankName</mca:CSharpReference>
                                  </OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="x:String">浦发银行</InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                            </scg:List>
                          </ui:MultipleAssign.AssignOperations>
                        </ui:MultipleAssign>
                        <InvokeMethod DisplayName="Invoke Method" sap:VirtualizedContainerService.HintSize="334,137" sap2010:WorkflowViewState.IdRef="InvokeMethod_7" MethodName="Add">
                          <InvokeMethod.TargetObject>
                            <InArgument x:TypeArguments="scg:List(cp:MessageDetailInfo)">
                              <mca:CSharpValue x:TypeArguments="scg:List(cp:MessageDetailInfo)" sap2010:WorkflowViewState.IdRef="CSharpValue`1_103">messageDetailStrs</mca:CSharpValue>
                            </InArgument>
                          </InvokeMethod.TargetObject>
                          <InArgument x:TypeArguments="cp:MessageDetailInfo">
                            <mca:CSharpValue x:TypeArguments="cp:MessageDetailInfo" sap2010:WorkflowViewState.IdRef="CSharpValue`1_102">tmpMessageInfo</mca:CSharpValue>
                          </InArgument>
                        </InvokeMethod>
                      </Sequence>
                    </ActivityAction>
                  </ui:ForEach.Body>
                  <ui:ForEach.Values>
                    <InArgument x:TypeArguments="sc:IEnumerable">
                      <mca:CSharpValue x:TypeArguments="sc:IEnumerable" sap2010:WorkflowViewState.IdRef="CSharpValue`1_104">detailMessages</mca:CSharpValue>
                    </InArgument>
                  </ui:ForEach.Values>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:ForEach>
              </Sequence>
              <Sequence x:Key="北京领英信息技术有限公司" sap:VirtualizedContainerService.HintSize="454,70" sap2010:WorkflowViewState.IdRef="Sequence_12">
                <Sequence.Variables>
                  <Variable x:TypeArguments="s:DateTime" Name="tmpMaxDate" />
                  <Variable x:TypeArguments="s:DateTime" Name="tmpMinDate" />
                  <Variable x:TypeArguments="scg:List(snm:MailMessage)" Name="detailMessages" />
                </Sequence.Variables>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="412,129" sap2010:WorkflowViewState.IdRef="MultipleAssign_11">
                  <ui:MultipleAssign.AssignOperations>
                    <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_31">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="s:DateTime">
                            <mca:CSharpReference x:TypeArguments="s:DateTime" sap2010:WorkflowViewState.IdRef="CSharpReference`1_44">tmpMaxDate</mca:CSharpReference>
                          </OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="s:DateTime">
                            <mca:CSharpValue x:TypeArguments="s:DateTime" sap2010:WorkflowViewState.IdRef="CSharpValue`1_207">item.Select(r=&gt;r.DaoKuanDate).Max().AddDays(5)</mca:CSharpValue>
                          </InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_32">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="s:DateTime">
                            <mca:CSharpReference x:TypeArguments="s:DateTime" sap2010:WorkflowViewState.IdRef="CSharpReference`1_45">tmpMinDate</mca:CSharpReference>
                          </OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="s:DateTime">
                            <mca:CSharpValue x:TypeArguments="s:DateTime" sap2010:WorkflowViewState.IdRef="CSharpValue`1_216">item.Select(r=&gt;r.DaoKuanDate).Min().AddDays(-5)</mca:CSharpValue>
                          </InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                    </scg:List>
                  </ui:MultipleAssign.AssignOperations>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:MultipleAssign>
                <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="获取邮件详情" sap:VirtualizedContainerService.HintSize="412,114" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_6" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Email\\GetMailMessage.xaml">
                  <ui:InvokeWorkflowFile.Arguments>
                    <InArgument x:TypeArguments="x:String" x:Key="account">
                      <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_73">account</mca:CSharpValue>
                    </InArgument>
                    <InArgument x:TypeArguments="x:String" x:Key="condition">
                      <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_82">"[SenderEmailAddress] = 'ap@linkedin.com' AND [ReceivedTime] &gt;= '"+tmpMinDate.ToString("d")+" 00:00AM' AND [ReceivedTime] &lt; '"+tmpMaxDate.ToString("d")+" 00:00AM'"</mca:CSharpValue>
                    </InArgument>
                    <OutArgument x:TypeArguments="scg:List(snm:MailMessage)" x:Key="messages">
                      <mca:CSharpReference x:TypeArguments="scg:List(snm:MailMessage)" sap2010:WorkflowViewState.IdRef="CSharpReference`1_46">detailMessages</mca:CSharpReference>
                    </OutArgument>
                    <InArgument x:TypeArguments="x:String" x:Key="mailFolder">收件箱\银行\领英账单</InArgument>
                  </ui:InvokeWorkflowFile.Arguments>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:InvokeWorkflowFile>
                <ui:ForEach x:TypeArguments="snm:MailMessage" CurrentIndex="{x:Null}" DisplayName="For Each" sap:VirtualizedContainerService.HintSize="412,628" sap2010:WorkflowViewState.IdRef="ForEach`1_8">
                  <ui:ForEach.Body>
                    <ActivityAction x:TypeArguments="snm:MailMessage">
                      <ActivityAction.Argument>
                        <DelegateInArgument x:TypeArguments="snm:MailMessage" Name="detailMessage" />
                      </ActivityAction.Argument>
                      <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="376,491" sap2010:WorkflowViewState.IdRef="Sequence_11">
                        <Sequence.Variables>
                          <Variable x:TypeArguments="scg:IEnumerable(x:String)" Name="tmpAttachmentPaths" />
                          <Variable x:TypeArguments="cp:MessageDetailInfo" Name="tmpMessageInfo" />
                        </Sequence.Variables>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="334,222" sap2010:WorkflowViewState.IdRef="MultipleAssign_12">
                          <ui:MultipleAssign.AssignOperations>
                            <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_33">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="cp:MessageDetailInfo">
                                    <mca:CSharpReference x:TypeArguments="cp:MessageDetailInfo" sap2010:WorkflowViewState.IdRef="CSharpReference`1_47">tmpMessageInfo</mca:CSharpReference>
                                  </OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="cp:MessageDetailInfo">
                                    <mca:CSharpValue x:TypeArguments="cp:MessageDetailInfo" sap2010:WorkflowViewState.IdRef="CSharpValue`1_75">new MessageDetailInfo()</mca:CSharpValue>
                                  </InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_34">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="x:String">
                                    <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_48">tmpMessageInfo.MessageId</mca:CSharpReference>
                                  </OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="x:String">
                                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_76">detailMessage.Headers.Get("Message-ID")</mca:CSharpValue>
                                  </InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_35">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="x:String">
                                    <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_49">tmpMessageInfo.MessageBody</mca:CSharpReference>
                                  </OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="x:String">
                                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_77">detailMessage.Body</mca:CSharpValue>
                                  </InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_36">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="x:String">
                                    <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_50">tmpMessageInfo.CompanyName</mca:CSharpReference>
                                  </OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="x:String">
                                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_78">item.Key</mca:CSharpValue>
                                  </InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_37">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="x:String">
                                    <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_51">tmpMessageInfo.BankName</mca:CSharpReference>
                                  </OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="x:String">浦发银行</InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                            </scg:List>
                          </ui:MultipleAssign.AssignOperations>
                        </ui:MultipleAssign>
                        <InvokeMethod DisplayName="Invoke Method" sap:VirtualizedContainerService.HintSize="334,137" sap2010:WorkflowViewState.IdRef="InvokeMethod_5" MethodName="Add">
                          <InvokeMethod.TargetObject>
                            <InArgument x:TypeArguments="scg:List(cp:MessageDetailInfo)">
                              <mca:CSharpValue x:TypeArguments="scg:List(cp:MessageDetailInfo)" sap2010:WorkflowViewState.IdRef="CSharpValue`1_80">messageDetailStrs</mca:CSharpValue>
                            </InArgument>
                          </InvokeMethod.TargetObject>
                          <InArgument x:TypeArguments="cp:MessageDetailInfo">
                            <mca:CSharpValue x:TypeArguments="cp:MessageDetailInfo" sap2010:WorkflowViewState.IdRef="CSharpValue`1_79">tmpMessageInfo</mca:CSharpValue>
                          </InArgument>
                        </InvokeMethod>
                      </Sequence>
                    </ActivityAction>
                  </ui:ForEach.Body>
                  <ui:ForEach.Values>
                    <InArgument x:TypeArguments="sc:IEnumerable">
                      <mca:CSharpValue x:TypeArguments="sc:IEnumerable" sap2010:WorkflowViewState.IdRef="CSharpValue`1_81">detailMessages</mca:CSharpValue>
                    </InArgument>
                  </ui:ForEach.Values>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:ForEach>
              </Sequence>
              <Sequence x:Key="亚马逊通技术服务（北京）有限公司" sap:VirtualizedContainerService.HintSize="454,1043" sap2010:WorkflowViewState.IdRef="Sequence_14">
                <Sequence.Variables>
                  <Variable x:TypeArguments="s:DateTime" Name="tmpMaxDate" />
                  <Variable x:TypeArguments="s:DateTime" Name="tmpMinDate" />
                  <Variable x:TypeArguments="scg:List(snm:MailMessage)" Name="detailMessages" />
                </Sequence.Variables>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="412,129" sap2010:WorkflowViewState.IdRef="MultipleAssign_13">
                  <ui:MultipleAssign.AssignOperations>
                    <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_38">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="s:DateTime">
                            <mca:CSharpReference x:TypeArguments="s:DateTime" sap2010:WorkflowViewState.IdRef="CSharpReference`1_52">tmpMaxDate</mca:CSharpReference>
                          </OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="s:DateTime">
                            <mca:CSharpValue x:TypeArguments="s:DateTime" sap2010:WorkflowViewState.IdRef="CSharpValue`1_209">item.Select(r=&gt;r.DaoKuanDate).Max().AddDays(5)</mca:CSharpValue>
                          </InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_39">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="s:DateTime">
                            <mca:CSharpReference x:TypeArguments="s:DateTime" sap2010:WorkflowViewState.IdRef="CSharpReference`1_53">tmpMinDate</mca:CSharpReference>
                          </OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="s:DateTime">
                            <mca:CSharpValue x:TypeArguments="s:DateTime" sap2010:WorkflowViewState.IdRef="CSharpValue`1_211">item.Select(r=&gt;r.DaoKuanDate).Min().AddDays(-5)</mca:CSharpValue>
                          </InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                    </scg:List>
                  </ui:MultipleAssign.AssignOperations>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:MultipleAssign>
                <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="获取邮件详情" sap:VirtualizedContainerService.HintSize="412,114" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_7" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Email\\GetMailMessage.xaml">
                  <ui:InvokeWorkflowFile.Arguments>
                    <InArgument x:TypeArguments="x:String" x:Key="account">
                      <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_86">account</mca:CSharpValue>
                    </InArgument>
                    <InArgument x:TypeArguments="x:String" x:Key="condition">
                      <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_85">"[SenderEmailAddress] = 'noreply@amazon.com' AND [ReceivedTime] &gt;= '"+tmpMinDate.ToString("d")+" 00:00AM' AND [ReceivedTime] &lt; '"+tmpMaxDate.ToString("d")+" 00:00AM'"</mca:CSharpValue>
                    </InArgument>
                    <OutArgument x:TypeArguments="scg:List(snm:MailMessage)" x:Key="messages">
                      <mca:CSharpReference x:TypeArguments="scg:List(snm:MailMessage)" sap2010:WorkflowViewState.IdRef="CSharpReference`1_54">detailMessages</mca:CSharpReference>
                    </OutArgument>
                    <InArgument x:TypeArguments="x:String" x:Key="mailFolder">收件箱\银行\亚马逊账单</InArgument>
                  </ui:InvokeWorkflowFile.Arguments>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:InvokeWorkflowFile>
                <ui:ForEach x:TypeArguments="snm:MailMessage" CurrentIndex="{x:Null}" DisplayName="For Each" sap:VirtualizedContainerService.HintSize="412,628" sap2010:WorkflowViewState.IdRef="ForEach`1_9">
                  <ui:ForEach.Body>
                    <ActivityAction x:TypeArguments="snm:MailMessage">
                      <ActivityAction.Argument>
                        <DelegateInArgument x:TypeArguments="snm:MailMessage" Name="detailMessage" />
                      </ActivityAction.Argument>
                      <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="376,491" sap2010:WorkflowViewState.IdRef="Sequence_13">
                        <Sequence.Variables>
                          <Variable x:TypeArguments="scg:IEnumerable(x:String)" Name="tmpAttachmentPaths" />
                          <Variable x:TypeArguments="cp:MessageDetailInfo" Name="tmpMessageInfo" />
                        </Sequence.Variables>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="334,222" sap2010:WorkflowViewState.IdRef="MultipleAssign_14">
                          <ui:MultipleAssign.AssignOperations>
                            <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_40">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="cp:MessageDetailInfo">
                                    <mca:CSharpReference x:TypeArguments="cp:MessageDetailInfo" sap2010:WorkflowViewState.IdRef="CSharpReference`1_55">tmpMessageInfo</mca:CSharpReference>
                                  </OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="cp:MessageDetailInfo">
                                    <mca:CSharpValue x:TypeArguments="cp:MessageDetailInfo" sap2010:WorkflowViewState.IdRef="CSharpValue`1_87">new MessageDetailInfo()</mca:CSharpValue>
                                  </InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_41">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="x:String">
                                    <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_56">tmpMessageInfo.MessageId</mca:CSharpReference>
                                  </OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="x:String">
                                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_88">detailMessage.Headers.Get("Message-ID")</mca:CSharpValue>
                                  </InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_42">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="x:String">
                                    <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_57">tmpMessageInfo.MessageBody</mca:CSharpReference>
                                  </OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="x:String">
                                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_89">detailMessage.Body</mca:CSharpValue>
                                  </InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_43">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="x:String">
                                    <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_58">tmpMessageInfo.CompanyName</mca:CSharpReference>
                                  </OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="x:String">
                                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_90">item.Key</mca:CSharpValue>
                                  </InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_44">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="x:String">
                                    <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_59">tmpMessageInfo.BankName</mca:CSharpReference>
                                  </OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="x:String">浦发银行</InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                            </scg:List>
                          </ui:MultipleAssign.AssignOperations>
                        </ui:MultipleAssign>
                        <InvokeMethod DisplayName="Invoke Method" sap:VirtualizedContainerService.HintSize="334,137" sap2010:WorkflowViewState.IdRef="InvokeMethod_6" MethodName="Add">
                          <InvokeMethod.TargetObject>
                            <InArgument x:TypeArguments="scg:List(cp:MessageDetailInfo)">
                              <mca:CSharpValue x:TypeArguments="scg:List(cp:MessageDetailInfo)" sap2010:WorkflowViewState.IdRef="CSharpValue`1_92">messageDetailStrs</mca:CSharpValue>
                            </InArgument>
                          </InvokeMethod.TargetObject>
                          <InArgument x:TypeArguments="cp:MessageDetailInfo">
                            <mca:CSharpValue x:TypeArguments="cp:MessageDetailInfo" sap2010:WorkflowViewState.IdRef="CSharpValue`1_91">tmpMessageInfo</mca:CSharpValue>
                          </InArgument>
                        </InvokeMethod>
                      </Sequence>
                    </ActivityAction>
                  </ui:ForEach.Body>
                  <ui:ForEach.Values>
                    <InArgument x:TypeArguments="sc:IEnumerable">
                      <mca:CSharpValue x:TypeArguments="sc:IEnumerable" sap2010:WorkflowViewState.IdRef="CSharpValue`1_93">detailMessages</mca:CSharpValue>
                    </InArgument>
                  </ui:ForEach.Values>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:ForEach>
              </Sequence>
            </Switch>
          </Sequence>
        </ActivityAction>
      </ui:ForEach.Body>
      <ui:ForEach.Values>
        <InArgument x:TypeArguments="sc:IEnumerable">
          <mca:CSharpValue x:TypeArguments="sc:IEnumerable" sap2010:WorkflowViewState.IdRef="CSharpValue`1_6">messageGroup</mca:CSharpValue>
        </InArgument>
      </ui:ForEach.Values>
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
          <x:Boolean x:Key="IsPinned">False</x:Boolean>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
    </ui:ForEach>
    <ui:ForEach x:TypeArguments="cp:MessageDetailInfo" CurrentIndex="{x:Null}" DisplayName="检出明细详情" sap:VirtualizedContainerService.HintSize="312,53" sap2010:WorkflowViewState.IdRef="ForEach`1_17">
      <ui:ForEach.Body>
        <ActivityAction x:TypeArguments="cp:MessageDetailInfo">
          <ActivityAction.Argument>
            <DelegateInArgument x:TypeArguments="cp:MessageDetailInfo" Name="item" />
          </ActivityAction.Argument>
          <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="546,659" sap2010:WorkflowViewState.IdRef="Sequence_17">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <Switch x:TypeArguments="x:String" DisplayName="Switch" sap:VirtualizedContainerService.HintSize="504,567" sap2010:WorkflowViewState.IdRef="Switch`1_2">
              <Switch.Expression>
                <InArgument x:TypeArguments="x:String">
                  <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_112">item.CompanyName</mca:CSharpValue>
                </InArgument>
              </Switch.Expression>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <Sequence x:Key="思爱普（中国）有限公司" sap:VirtualizedContainerService.HintSize="376,256" sap2010:WorkflowViewState.IdRef="Sequence_18">
                <Sequence.Variables>
                  <Variable x:TypeArguments="s:DateTime" Name="tmpMaxDate" />
                  <Variable x:TypeArguments="s:DateTime" Name="tmpMinDate" />
                  <Variable x:TypeArguments="scg:List(snm:MailMessage)" Name="detailMessages" />
                </Sequence.Variables>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <ui:InvokeCode ContinueOnError="{x:Null}" Code="            var splitStartStr = &quot;------------------------------------------------------------------------&quot;;&#xA;            var startIndex = tmpMessageInfo.MessageBody.LastIndexOf(splitStartStr);&#xA;            var splitEndStr = &quot;Total&quot;;&#xA;            var endIndex = tmpMessageInfo.MessageBody.LastIndexOf(splitEndStr);&#xA;            var suffixLength = tmpMessageInfo.MessageBody.Length - endIndex;&#xA;            var tmpStr = tmpMessageInfo.MessageBody.Substring(startIndex + splitStartStr.Length, tmpMessageInfo.MessageBody.Length - startIndex - suffixLength - splitStartStr.Length);&#xA;            var arr = tmpStr.Split(new char[2] { '\r', '\n' }, StringSplitOptions.RemoveEmptyEntries);&#xA;            var mergeArr = new List&lt;string&gt;(arr.Length / 2);&#xA;            for (int i = 0; i &lt; arr.Length; i++)&#xA;            {&#xA;                if (i % 2 == 0)&#xA;                {&#xA;                    mergeArr.Add(arr[i] + &quot; &quot; + arr[i + 1]);&#xA;                }&#xA;            }&#xA;            foreach (var item in mergeArr)&#xA;            {&#xA;                var row = item.Split(new char[1]{' '}, StringSplitOptions.RemoveEmptyEntries);&#xA;&#x9;&#x9;&#x9;&#x9;var av = 0m;&#xA;&#x9;&#x9;&#x9;&#x9;decimal.TryParse(row[3],out av);&#xA;&#x9;&#x9;&#x9;&#x9;var tmpDetail = new MessageDetailInfo&#xA;&#x9;&#x9;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;MessageId = tmpMessageInfo.MessageId,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;MessageBody = tmpMessageInfo.MessageBody.Replace(&quot;,&quot;,&quot;，&quot;).Replace(&quot;\r\n&quot;,&quot; &quot;),&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CompanyName = tmpMessageInfo.CompanyName,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;BankName = tmpMessageInfo.BankName,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;DaoKuanDate = tmpMessageInfo.DaoKuanDate,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;InvoiceNo = row[0],&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Amount = av,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;DiscountAmount = 0m&#xA;&#x9;&#x9;&#x9;&#x9;};&#xA;&#x9;&#x9;&#x9;&#x9;messageDetails.Add(tmpDetail);&#xA;            }" DisplayName="Invoke code" sap:VirtualizedContainerService.HintSize="334,164" sap2010:WorkflowViewState.IdRef="InvokeCode_7" Language="CSharp">
                  <ui:InvokeCode.Arguments>
                    <InArgument x:TypeArguments="cp:MessageDetailInfo" x:Key="tmpMessageInfo">
                      <mca:CSharpValue x:TypeArguments="cp:MessageDetailInfo" sap2010:WorkflowViewState.IdRef="CSharpValue`1_113">item</mca:CSharpValue>
                    </InArgument>
                    <InOutArgument x:TypeArguments="scg:List(cp:MessageDetailInfo)" x:Key="messageDetails">
                      <mca:CSharpReference x:TypeArguments="scg:List(cp:MessageDetailInfo)" sap2010:WorkflowViewState.IdRef="CSharpReference`1_119">messageDetails</mca:CSharpReference>
                    </InOutArgument>
                  </ui:InvokeCode.Arguments>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:InvokeCode>
              </Sequence>
              <Sequence x:Key="微软（中国）有限公司" sap:VirtualizedContainerService.HintSize="376,256" sap2010:WorkflowViewState.IdRef="Sequence_20">
                <Sequence.Variables>
                  <Variable x:TypeArguments="s:DateTime" Name="tmpMaxDate" />
                  <Variable x:TypeArguments="s:DateTime" Name="tmpMinDate" />
                  <Variable x:TypeArguments="scg:List(snm:MailMessage)" Name="detailMessages" />
                </Sequence.Variables>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <ui:InvokeCode ContinueOnError="{x:Null}" Code="&#x9;var splitStartStr = &quot;NET AMOUNT&quot;;&#xA;    var prefixLength = tmpMessageInfo.MessageBody.LastIndexOf(splitStartStr);&#xA;    var splitEndStr = &quot;-----------------------------------------------------------------------&quot;;&#xA;    var endIndex = tmpMessageInfo.MessageBody.LastIndexOf(splitEndStr);&#xA;    var suffixLength = tmpMessageInfo.MessageBody.Length - endIndex;&#xA;    var tmpStr = tmpMessageInfo.MessageBody.Substring(prefixLength + splitStartStr.Length, tmpMessageInfo.MessageBody.Length - prefixLength - suffixLength - splitStartStr.Length);&#xA;    tmpStr = tmpStr.Replace(&quot;\r\n     WITHHOLDING TAX : &quot;, &quot; &quot;);&#xA;    var tmpRowStr = tmpStr.Split(new char[2] { '\r', '\n' }, StringSplitOptions.RemoveEmptyEntries);&#xA;    foreach (var item in tmpRowStr)&#xA;    {&#xA;        var row = item.Split(new Char[1]{' '}, StringSplitOptions.RemoveEmptyEntries);&#xA;&#x9;&#x9;var av = 0m;&#xA;&#x9;&#x9;var dv = 0m;&#xA;&#x9;&#x9;decimal.TryParse(row[2],out av);&#xA;&#x9;&#x9;decimal.TryParse(row[3],out dv);&#xA;&#x9;&#x9;var tmpDetail = new MessageDetailInfo&#xA;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;MessageId = tmpMessageInfo.MessageId,&#xA;&#x9;&#x9;&#x9;MessageBody = tmpMessageInfo.MessageBody.Replace(&quot;,&quot;,&quot;，&quot;).Replace(&quot;\r\n&quot;,&quot; &quot;),&#xA;&#x9;&#x9;&#x9;CompanyName = tmpMessageInfo.CompanyName,&#xA;&#x9;&#x9;&#x9;BankName = tmpMessageInfo.BankName,&#xA;&#x9;&#x9;&#x9;DaoKuanDate = tmpMessageInfo.DaoKuanDate,&#xA;&#x9;&#x9;&#x9;InvoiceNo = row[1],&#xA;&#x9;&#x9;&#x9;Amount = av,&#xA;&#x9;&#x9;&#x9;DiscountAmount = dv&#xA;&#x9;&#x9;};&#xA;&#x9;&#x9;messageDetails.Add(tmpDetail);&#xA;    }" DisplayName="Invoke code" sap:VirtualizedContainerService.HintSize="334,164" sap2010:WorkflowViewState.IdRef="InvokeCode_13" Language="CSharp">
                  <ui:InvokeCode.Arguments>
                    <InArgument x:TypeArguments="cp:MessageDetailInfo" x:Key="tmpMessageInfo">
                      <mca:CSharpValue x:TypeArguments="cp:MessageDetailInfo" sap2010:WorkflowViewState.IdRef="CSharpValue`1_180">item</mca:CSharpValue>
                    </InArgument>
                    <InOutArgument x:TypeArguments="scg:List(cp:MessageDetailInfo)" x:Key="messageDetails">
                      <mca:CSharpReference x:TypeArguments="scg:List(cp:MessageDetailInfo)" sap2010:WorkflowViewState.IdRef="CSharpReference`1_120">messageDetails</mca:CSharpReference>
                    </InOutArgument>
                  </ui:InvokeCode.Arguments>
                </ui:InvokeCode>
              </Sequence>
              <Sequence x:Key="甲骨文（中国）软件系统有限公司" sap:VirtualizedContainerService.HintSize="376,256" sap2010:WorkflowViewState.IdRef="Sequence_22">
                <Sequence.Variables>
                  <Variable x:TypeArguments="s:DateTime" Name="tmpMaxDate" />
                  <Variable x:TypeArguments="s:DateTime" Name="tmpMinDate" />
                  <Variable x:TypeArguments="scg:List(snm:MailMessage)" Name="detailMessages" />
                </Sequence.Variables>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <ui:InvokeCode ContinueOnError="{x:Null}" Code="&#x9;var splitStartStr = &quot;Amount Paid&quot;;&#xA;    var startIndex = tmpMessageInfo.MessageBody.LastIndexOf(splitStartStr);&#xA;    var splitEndStr = &quot;Total&quot;;&#xA;    var endIndex = tmpMessageInfo.MessageBody.LastIndexOf(splitEndStr);&#xA;    var suffixLength = tmpMessageInfo.MessageBody.Length - endIndex;&#xA;    var tmpStr = tmpMessageInfo.MessageBody.Substring(startIndex + splitStartStr.Length, tmpMessageInfo.MessageBody.Length - startIndex - suffixLength - splitStartStr.Length);&#xA;    tmpStr = tmpStr.Trim(new char[2] { '\r', '\n' });&#xA;    tmpStr = tmpStr.Trim('\t');&#xA;    var arr = tmpStr.Split(new char[2] { '\r', '\n' }, StringSplitOptions.RemoveEmptyEntries);&#xA;&#x9;var dict = new List&lt;KeyValuePair&lt;int,string&gt;&gt;();&#xA;    for (int i = 0; i &lt; arr.Length; i++)&#xA;    {&#xA;        if (arr[i] == &quot;CNY&quot;)&#xA;        {&#xA;            dict.Add(new KeyValuePair&lt;int, string&gt;(i, &quot;CNY&quot;));&#xA;        }&#xA;        if (arr[i].Contains(&quot;\t&quot;))&#xA;        {&#xA;            dict.Add(new KeyValuePair&lt;int, string&gt;(i, &quot;\t&quot;));&#xA;        }&#xA;    }&#xA;    for (int i = 0; i &lt; dict.Count; i++)&#xA;    {&#xA;        if (i % 2 == 0)&#xA;        {&#xA;&#x9;&#x9;&#x9;var av = 0m;&#xA;&#x9;&#x9;&#x9;decimal.TryParse(arr[dict[i + 1].Key + 3],out av);&#xA;&#x9;&#x9;&#x9;var tmpDetail = new MessageDetailInfo&#xA;&#x9;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;&#x9;MessageId = tmpMessageInfo.MessageId,&#xA;&#x9;&#x9;&#x9;&#x9;MessageBody = tmpMessageInfo.MessageBody.Replace(&quot;,&quot;,&quot;，&quot;).Replace(&quot;\r\n&quot;,&quot; &quot;),&#xA;&#x9;&#x9;&#x9;&#x9;CompanyName = tmpMessageInfo.CompanyName,&#xA;&#x9;&#x9;&#x9;&#x9;BankName = tmpMessageInfo.BankName,&#xA;&#x9;&#x9;&#x9;&#x9;DaoKuanDate = tmpMessageInfo.DaoKuanDate,&#xA;&#x9;&#x9;&#x9;&#x9;InvoiceNo = arr[dict[i].Key - 2],&#xA;&#x9;&#x9;&#x9;&#x9;Amount = av,&#xA;&#x9;&#x9;&#x9;&#x9;DiscountAmount = 0m&#xA;&#x9;&#x9;&#x9;};&#xA;&#x9;&#x9;&#x9;messageDetails.Add(tmpDetail);&#xA;        }&#xA;    }" DisplayName="Invoke code" sap:VirtualizedContainerService.HintSize="334,164" sap2010:WorkflowViewState.IdRef="InvokeCode_14" Language="CSharp">
                  <ui:InvokeCode.Arguments>
                    <InArgument x:TypeArguments="cp:MessageDetailInfo" x:Key="tmpMessageInfo">
                      <mca:CSharpValue x:TypeArguments="cp:MessageDetailInfo" sap2010:WorkflowViewState.IdRef="CSharpValue`1_182">item</mca:CSharpValue>
                    </InArgument>
                    <InOutArgument x:TypeArguments="scg:List(cp:MessageDetailInfo)" x:Key="messageDetails">
                      <mca:CSharpReference x:TypeArguments="scg:List(cp:MessageDetailInfo)" sap2010:WorkflowViewState.IdRef="CSharpReference`1_121">messageDetails</mca:CSharpReference>
                    </InOutArgument>
                  </ui:InvokeCode.Arguments>
                </ui:InvokeCode>
              </Sequence>
              <ui:InvokeCode ContinueOnError="{x:Null}" x:Key="宁夏西云数据科技有限公司" Code="&#x9;var spliteStartStr = &quot;Amount Remaining&quot;;&#xA;    var index = tmpMessageInfo.MessageBody.LastIndexOf(spliteStartStr);&#xA;    var tmpStr = tmpMessageInfo.MessageBody.Substring(index + spliteStartStr.Length, tmpMessageInfo.MessageBody.Length - index - spliteStartStr.Length);&#xA;    tmpStr = tmpStr.Trim(new char[2] { '\r', '\n' });&#xA;    tmpStr = tmpStr.Trim();&#xA;    var arr = tmpStr.Split(new char[2] { '\r', '\n' }, StringSplitOptions.RemoveEmptyEntries);&#xA;    var loop = arr.Length / 5;&#xA;    for (int i = 0; i &lt; loop; i++)&#xA;    {&#xA;&#x9;&#x9;var av = 0m;&#xA;&#x9;&#x9;decimal.TryParse(arr[3 + i * 5],out av);&#xA;&#x9;&#x9;&#xA;&#x9;&#x9;var tmpDetail = new MessageDetailInfo&#xA;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;MessageId = tmpMessageInfo.MessageId,&#xA;&#x9;&#x9;&#x9;MessageBody = tmpMessageInfo.MessageBody.Replace(&quot;,&quot;,&quot;，&quot;).Replace(&quot;\r\n&quot;,&quot; &quot;),&#xA;&#x9;&#x9;&#x9;CompanyName = tmpMessageInfo.CompanyName,&#xA;&#x9;&#x9;&#x9;BankName = tmpMessageInfo.BankName,&#xA;&#x9;&#x9;&#x9;DaoKuanDate = tmpMessageInfo.DaoKuanDate,&#xA;&#x9;&#x9;&#x9;InvoiceNo = arr[0 + i * 5],&#xA;&#x9;&#x9;&#x9;Amount = av,&#xA;&#x9;&#x9;&#x9;DiscountAmount = 0m&#xA;&#x9;&#x9;};&#xA;&#x9;&#x9;messageDetails.Add(tmpDetail);&#xA;    }" DisplayName="Invoke code" sap:VirtualizedContainerService.HintSize="334,164" sap2010:WorkflowViewState.IdRef="InvokeCode_15" Language="CSharp">
                <ui:InvokeCode.Arguments>
                  <InArgument x:TypeArguments="cp:MessageDetailInfo" x:Key="tmpMessageInfo">
                    <mca:CSharpValue x:TypeArguments="cp:MessageDetailInfo" sap2010:WorkflowViewState.IdRef="CSharpValue`1_183">item</mca:CSharpValue>
                  </InArgument>
                  <InOutArgument x:TypeArguments="scg:List(cp:MessageDetailInfo)" x:Key="messageDetails">
                    <mca:CSharpReference x:TypeArguments="scg:List(cp:MessageDetailInfo)" sap2010:WorkflowViewState.IdRef="CSharpReference`1_122">messageDetails</mca:CSharpReference>
                  </InOutArgument>
                </ui:InvokeCode.Arguments>
              </ui:InvokeCode>
              <ui:InvokeCode ContinueOnError="{x:Null}" x:Key="北京领英信息技术有限公司" Code="    var splitStartStr = &quot;支付金额&quot;;&#xA;    var startIndex = tmpMessageInfo.MessageBody.LastIndexOf(splitStartStr);&#xA;    var splitEndStr = &quot;总计&quot;;&#xA;    var endIndex = tmpMessageInfo.MessageBody.LastIndexOf(splitEndStr);&#xA;    var suffixLength = tmpMessageInfo.MessageBody.Length - endIndex;&#xA;    var tmpStr = tmpMessageInfo.MessageBody.Substring(startIndex + splitStartStr.Length, tmpMessageInfo.MessageBody.Length - startIndex - suffixLength - splitStartStr.Length);&#xA;    tmpStr = tmpStr.Trim('\t');&#xA;    var arr = tmpStr.Split(new char[2] { '\r', '\n' }, StringSplitOptions.RemoveEmptyEntries);&#xA;&#x9;var dict = new List&lt;KeyValuePair&lt;int,string&gt;&gt;();&#xA;    for (int i = 0; i &lt; arr.Length; i++)&#xA;    {&#xA;        if (arr[i] == &quot;CNY&quot;)&#xA;        {&#xA;            dict.Add(new KeyValuePair&lt;int, string&gt;(i, &quot;CNY&quot;));&#xA;        }&#xA;        if (arr[i].Contains(&quot;\t&quot;))&#xA;        {&#xA;            dict.Add(new KeyValuePair&lt;int, string&gt;(i, &quot;\t&quot;));&#xA;        }&#xA;    }&#xA;    for (int i = 0; i &lt; dict.Count; i++)&#xA;    {&#xA;        if (i % 2 == 0)&#xA;        {&#xA;&#x9;&#x9;&#x9;var av = 0m;&#xA;&#x9;&#x9;&#x9;decimal.TryParse(arr[dict[i + 1].Key + 1],out av);&#xA;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;var tmpDetail = new MessageDetailInfo&#xA;&#x9;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;&#x9;MessageId = tmpMessageInfo.MessageId,&#xA;&#x9;&#x9;&#x9;&#x9;MessageBody = tmpMessageInfo.MessageBody.Replace(&quot;,&quot;,&quot;，&quot;).Replace(&quot;\r\n&quot;,&quot; &quot;),&#xA;&#x9;&#x9;&#x9;&#x9;CompanyName = tmpMessageInfo.CompanyName,&#xA;&#x9;&#x9;&#x9;&#x9;BankName = tmpMessageInfo.BankName,&#xA;&#x9;&#x9;&#x9;&#x9;DaoKuanDate = tmpMessageInfo.DaoKuanDate,&#xA;&#x9;&#x9;&#x9;&#x9;InvoiceNo = arr[dict[i].Key - 3],&#xA;&#x9;&#x9;&#x9;&#x9;Amount = av,&#xA;&#x9;&#x9;&#x9;&#x9;DiscountAmount = 0m&#xA;&#x9;&#x9;&#x9;};&#xA;&#x9;&#x9;&#x9;messageDetails.Add(tmpDetail);&#xA;        }&#xA;    }" DisplayName="Invoke code" sap:VirtualizedContainerService.HintSize="334,53" sap2010:WorkflowViewState.IdRef="InvokeCode_16" Language="CSharp">
                <ui:InvokeCode.Arguments>
                  <InArgument x:TypeArguments="cp:MessageDetailInfo" x:Key="tmpMessageInfo">
                    <mca:CSharpValue x:TypeArguments="cp:MessageDetailInfo" sap2010:WorkflowViewState.IdRef="CSharpValue`1_184">item</mca:CSharpValue>
                  </InArgument>
                  <InOutArgument x:TypeArguments="scg:List(cp:MessageDetailInfo)" x:Key="messageDetails">
                    <mca:CSharpReference x:TypeArguments="scg:List(cp:MessageDetailInfo)" sap2010:WorkflowViewState.IdRef="CSharpReference`1_123">messageDetails</mca:CSharpReference>
                  </InOutArgument>
                </ui:InvokeCode.Arguments>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
              </ui:InvokeCode>
              <ui:InvokeCode ContinueOnError="{x:Null}" x:Key="亚马逊通技术服务（北京）有限公司" Code="&#x9;var spliteStartStr = &quot;Amount Remaining&quot;;&#xA;    var index = tmpMessageInfo.MessageBody.LastIndexOf(spliteStartStr);&#xA;    var tmpStr = tmpMessageInfo.MessageBody.Substring(index + spliteStartStr.Length, tmpMessageInfo.MessageBody.Length - index - spliteStartStr.Length);&#xA;    tmpStr = tmpStr.Trim(new char[2] { '\r', '\n' });&#xA;    tmpStr = tmpStr.Trim();&#xA;    var arr = tmpStr.Split(new char[2] { '\r', '\n' }, StringSplitOptions.RemoveEmptyEntries);&#xA;    for (int i = 0; i &lt; arr.Length; i++)&#xA;    {&#xA;&#x9;&#x9;var sp = arr[i].Split('\t');&#xA;&#x9;&#x9;var av = 0m;&#xA;&#x9;&#x9;decimal.TryParse(sp[4],out av);&#xA;        tmpMessageInfo.Amount = av;&#xA;&#x9;&#x9;&#xA;&#x9;&#x9;var tmpDetail = new MessageDetailInfo&#xA;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;MessageId = tmpMessageInfo.MessageId,&#xA;&#x9;&#x9;&#x9;MessageBody = tmpMessageInfo.MessageBody.Replace(&quot;,&quot;,&quot;，&quot;).Replace(&quot;\r\n&quot;,&quot; &quot;),&#xA;&#x9;&#x9;&#x9;CompanyName = tmpMessageInfo.CompanyName,&#xA;&#x9;&#x9;&#x9;BankName = tmpMessageInfo.BankName,&#xA;&#x9;&#x9;&#x9;DaoKuanDate = tmpMessageInfo.DaoKuanDate,&#xA;&#x9;&#x9;&#x9;InvoiceNo = sp[0],&#xA;&#x9;&#x9;&#x9;Amount = av,&#xA;&#x9;&#x9;&#x9;DiscountAmount = 0m&#xA;&#x9;&#x9;};&#xA;&#x9;&#x9;messageDetails.Add(tmpDetail);&#xA;    }" DisplayName="Invoke code" sap:VirtualizedContainerService.HintSize="334,53" sap2010:WorkflowViewState.IdRef="InvokeCode_17" Language="CSharp">
                <ui:InvokeCode.Arguments>
                  <InArgument x:TypeArguments="cp:MessageDetailInfo" x:Key="tmpMessageInfo">
                    <mca:CSharpValue x:TypeArguments="cp:MessageDetailInfo" sap2010:WorkflowViewState.IdRef="CSharpValue`1_185">item</mca:CSharpValue>
                  </InArgument>
                  <InOutArgument x:TypeArguments="scg:List(cp:MessageDetailInfo)" x:Key="messageDetails">
                    <mca:CSharpReference x:TypeArguments="scg:List(cp:MessageDetailInfo)" sap2010:WorkflowViewState.IdRef="CSharpReference`1_124">messageDetails</mca:CSharpReference>
                  </InOutArgument>
                </ui:InvokeCode.Arguments>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
              </ui:InvokeCode>
            </Switch>
          </Sequence>
        </ActivityAction>
      </ui:ForEach.Body>
      <ui:ForEach.Values>
        <InArgument x:TypeArguments="sc:IEnumerable">
          <mca:CSharpValue x:TypeArguments="sc:IEnumerable" sap2010:WorkflowViewState.IdRef="CSharpValue`1_177">messageDetailStrs</mca:CSharpValue>
        </InArgument>
      </ui:ForEach.Values>
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
          <x:Boolean x:Key="IsPinned">False</x:Boolean>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
    </ui:ForEach>
    <Assign sap:VirtualizedContainerService.HintSize="312,61" sap2010:WorkflowViewState.IdRef="Assign_2">
      <Assign.To>
        <OutArgument x:TypeArguments="scg:IEnumerable(scg:KeyValuePair(x:String, x:Decimal))">
          <mca:CSharpReference x:TypeArguments="scg:IEnumerable(scg:KeyValuePair(x:String, x:Decimal))" sap2010:WorkflowViewState.IdRef="CSharpReference`1_126">sums</mca:CSharpReference>
        </OutArgument>
      </Assign.To>
      <Assign.Value>
        <InArgument x:TypeArguments="scg:IEnumerable(scg:KeyValuePair(x:String, x:Decimal))">
          <mca:CSharpValue x:TypeArguments="scg:IEnumerable(scg:KeyValuePair(x:String, x:Decimal))" sap2010:WorkflowViewState.IdRef="CSharpValue`1_195">messageDetails.GroupBy(r=&gt;r.MessageId).Select(r=&gt;new KeyValuePair&lt;string,decimal&gt;(r.Key,r.Sum(a=&gt;a.Amount - a.DiscountAmount)))</mca:CSharpValue>
        </InArgument>
      </Assign.Value>
    </Assign>
    <ui:ForEach x:TypeArguments="cp:MessageNoticeInfo" CurrentIndex="{x:Null}" DisplayName="匹配到款通知和详情" sap:VirtualizedContainerService.HintSize="312,207" sap2010:WorkflowViewState.IdRef="ForEach`1_18">
      <ui:ForEach.Body>
        <ActivityAction x:TypeArguments="cp:MessageNoticeInfo">
          <ActivityAction.Argument>
            <DelegateInArgument x:TypeArguments="cp:MessageNoticeInfo" Name="item" />
          </ActivityAction.Argument>
          <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="200,70" sap2010:WorkflowViewState.IdRef="Sequence_23">
            <Sequence.Variables>
              <Variable x:TypeArguments="scg:IEnumerable(x:String)" Name="tmpMessageIds" />
            </Sequence.Variables>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <If sap:VirtualizedContainerService.HintSize="484,405" sap2010:WorkflowViewState.IdRef="If_1">
              <If.Condition>
                <InArgument x:TypeArguments="x:Boolean">
                  <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_190">sums.Any(r=&gt;r.Value == item.Amount)</mca:CSharpValue>
                </InArgument>
              </If.Condition>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <If.Then>
                <Sequence sap:VirtualizedContainerService.HintSize="376,221" sap2010:WorkflowViewState.IdRef="Sequence_24">
                  <Sequence.Variables>
                    <Variable x:TypeArguments="scg:List(cp:MessageDetailInfo)" Name="debugDetails" />
                  </Sequence.Variables>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <ui:MultipleAssign DisplayName="获取匹配的详情" sap:VirtualizedContainerService.HintSize="334,129" sap2010:WorkflowViewState.IdRef="MultipleAssign_17">
                    <ui:MultipleAssign.AssignOperations>
                      <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_52">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="scg:IEnumerable(x:String)">
                              <mca:CSharpReference x:TypeArguments="scg:IEnumerable(x:String)" sap2010:WorkflowViewState.IdRef="CSharpReference`1_130">tmpMessageIds</mca:CSharpReference>
                            </OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="scg:IEnumerable(x:String)">
                              <mca:CSharpValue x:TypeArguments="scg:IEnumerable(x:String)" sap2010:WorkflowViewState.IdRef="CSharpValue`1_220">sums.Where(r=&gt;r.Value == item.Amount).Select(r=&gt;r.Key)</mca:CSharpValue>
                            </InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_53">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="scg:List(cp:MessageDetailInfo)">
                              <mca:CSharpReference x:TypeArguments="scg:List(cp:MessageDetailInfo)" sap2010:WorkflowViewState.IdRef="CSharpReference`1_131">item.Details</mca:CSharpReference>
                            </OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="scg:List(cp:MessageDetailInfo)">
                              <mca:CSharpValue x:TypeArguments="scg:List(cp:MessageDetailInfo)" sap2010:WorkflowViewState.IdRef="CSharpValue`1_221">messageDetails.Where(r=&gt;tmpMessageIds.Contains(r.MessageId)).ToList()</mca:CSharpValue>
                            </InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                      </scg:List>
                    </ui:MultipleAssign.AssignOperations>
                  </ui:MultipleAssign>
                </Sequence>
              </If.Then>
            </If>
          </Sequence>
        </ActivityAction>
      </ui:ForEach.Body>
      <ui:ForEach.Values>
        <InArgument x:TypeArguments="sc:IEnumerable">
          <mca:CSharpValue x:TypeArguments="sc:IEnumerable" sap2010:WorkflowViewState.IdRef="CSharpValue`1_189">messageInfos</mca:CSharpValue>
        </InArgument>
      </ui:ForEach.Values>
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          <x:Boolean x:Key="IsPinned">False</x:Boolean>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
    </ui:ForEach>
    <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,95" sap2010:WorkflowViewState.IdRef="LogMessage_1" Level="Info">
      <ui:LogMessage.Message>
        <InArgument x:TypeArguments="x:Object">
          <mca:CSharpValue x:TypeArguments="x:Object" sap2010:WorkflowViewState.IdRef="CSharpValue`1_225">string.Join(",",messageInfos.Select(r=&gt;r.CompanyName))</mca:CSharpValue>
        </InArgument>
      </ui:LogMessage.Message>
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
          <x:Boolean x:Key="IsPinned">False</x:Boolean>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
    </ui:LogMessage>
  </Sequence>
</Activity>